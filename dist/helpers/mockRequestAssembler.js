"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const request_1=__importDefault(require("request")),lodash_1=__importDefault(require("lodash")),kContentLengthKey="content-length";exports.createBuffer=(e=>{if(e&&!lodash_1.default.isEmpty(e))return Buffer.from(JSON.stringify(e))}),exports.lengthForBuffer=((e,t)=>"GET"===e.toUpperCase()||"DELETE"===e.toUpperCase()||lodash_1.default.isEmpty(t)?0:Buffer.byteLength(JSON.stringify(t),"gzip")),exports.constructURL=((e,t,r,o)=>{return`${e.protocol}://${e.hostname}:${r}/${o}${t.path}${t.request.params||""}`});const constructRequest=(e,t,r,o)=>({headers:e,method:t,body:"GET"===t?null:o,uri:r});exports.sendMockedRequest=((e,t,r,o,s)=>{const u=exports.constructURL(e,o,s,r),n=exports.createBuffer(o.request.body),f=exports.lengthForBuffer(e.method,o.request.body),p=e.headers;p["content-length"]=String(f);const a=constructRequest(p,e.method,u,n);request_1.default(a).pipe(t)});